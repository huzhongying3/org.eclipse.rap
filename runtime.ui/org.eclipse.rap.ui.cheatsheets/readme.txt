Based on code from dev.eclipse.org:/cvsroot/eclipse, Tag v20081205